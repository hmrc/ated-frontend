@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import models._
@import config.ApplicationConfig
@import play.twirl.api.HtmlFormat
@import views.html.helpers._
@import utils._
@import uk.gov.hmrc.govukfrontend.views.Implicits._
@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.hmrcfrontend.views.Implicits.RichErrorSummary
@import uk.gov.hmrc.govukfrontend.views.Implicits.RichCheckboxes
@import uk.gov.hmrc.hmrcfrontend.views.Implicits.RichDateInput
@import views.ViewUtils.titleBuilder
@import models.StringFormatting._

@this(newMain: newMain,
  formHelper: FormWithCSRF,
  govukDateInput: GovukDateInput,
  govukErrorSummary: GovukErrorSummary,
  govukCheckboxes : GovukCheckboxes,
  govukBackLink : GovukBackLink,
  govukButton : GovukButton,
  govukWarningText : GovukWarningText)

@(periodKey: Int,
  reliefsForm: Form[Reliefs],
  periodStartDate: java.time.LocalDate,
  serviceInfoContent: Html = HtmlFormat.empty, backLink: Option[String])(implicit authContext: StandardAuthRetrievals, messages: Messages, request: Request[AnyContent], appConfig: ApplicationConfig)

@formattedPeriodStartDate = @{periodStartDate.toString(messages("ated.date-format.numeric"))}

@chooseReliefsocialHousingMessage = @{
  if (periodKey >= 2020) {
    "ated.choose-reliefs.providerSocialOrHousing"
  } else {
    "ated.choose-reliefs.socialHousing"
  }
}

@chooseSingleReliefsocialHousingMessage = @{
  if (periodKey >= 2020) {
    "ated.choose-single-relief.providerSocialOrHousing"
  } else {
    "ated.choose-single-relief.socialHousing"
  }
}

@amendedForm = @{
  if (periodKey >= 2020) {
    reliefsForm.copy(errors = reliefsForm.errors.map(
      error => if(error.args.headOption.contains("socialHousingDate")) {
        error.copy(args = Seq("providerSocialOrHousingDate"))
      } else {
        error
      }
    ))
  } else {
    reliefsForm
  }
}

@backLinkHtml = {
    @if(backLink.isDefined) {
        @govukBackLink(BackLink(
            href = backLink.get,
            content = Text("Back")
        ))
    }
}

@inputItems = @{
    Seq(InputItem(attributes = Map("maxLength" -> "2")),
        InputItem(attributes = Map("maxLength" -> "2")),
        InputItem(attributes = Map("maxLength" -> "4"))
    )
}

@rentalBusinessDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="rentalBusinessDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.rentalBusiness"))
        </legend>
        <div id="rentalBusinessDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="rentalBusinessDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.rentalBusiness.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="rentalBusinessDate-day" name="rentalBusinessDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="rentalBusinessDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.rentalBusiness.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="rentalBusinessDate-month" name="rentalBusinessDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="rentalBusinessDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.rentalBusiness.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="rentalBusinessDate-year" name="rentalBusinessDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>

}

@openToPublicDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="openToPublicDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.openToPublic"))
        </legend>
        <div id="openToPublicDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="openToPublicDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.openToPublic.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="openToPublicDate-day" name="openToPublicDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="openToPublicDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.openToPublic.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="openToPublicDate-month" name="openToPublicDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="openToPublicDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.openToPublic.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="openToPublicDate-year" name="openToPublicDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@propertyDeveloperDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="propertyDeveloperDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.propertyDeveloper"))
        </legend>
        <div id="propertyDeveloperDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyDeveloperDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyDeveloper.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="propertyDeveloperDate-day" name="propertyDeveloperDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyDeveloperDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyDeveloper.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="propertyDeveloperDate-month" name="propertyDeveloperDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyDeveloperDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyDeveloper.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="propertyDeveloperDate-year" name="propertyDeveloperDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@propertyTradingDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="propertyTradingDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.propertyTrading"))
        </legend>
        <div id="propertyTradingDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyTradingDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyTrading.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="propertyTradingDate-day" name="propertyTradingDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyTradingDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyTrading.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="propertyTradingDate-month" name="propertyTradingDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="propertyTradingDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.propertyTrading.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="propertyTradingDate-year" name="propertyDeveloperDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>

}

@lendingDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="lendingDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.lending"))
        </legend>
        <div id="lendingDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="lendingDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.lending.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="lendingDate-day" name="lendingDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="lendingDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.lending.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="lendingDate-month" name="lendingDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="lendingDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.lending.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="lendingDate-year" name="lendingDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@employeeOccupationDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="employeeOccupationDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.employeeOccupation"))
        </legend>
        <div id="employeeOccupationDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="employeeOccupationDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.employeeOccupation.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="employeeOccupationDate-day" name="employeeOccupationDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="employeeOccupationDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.employeeOccupation.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="employeeOccupationDate-month" name="employeeOccupationDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="employeeOccupationDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.employeeOccupation.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="employeeOccupationDate-year" name="employeeOccupationDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@farmHousesDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="farmHousesDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.farmHouses"))
        </legend>
        <div id="farmHousesDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="farmHousesDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.farmHouses.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="farmHousesDate-day" name="farmHousesDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="farmHousesDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.farmHouses.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="farmHousesDate-month" name="farmHousesDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="farmHousesDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.farmHouses.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="farmHousesDate-year" name="farmHousesDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@socialHousingDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="socialHousingDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages(chooseSingleReliefsocialHousingMessage))
        </legend>
        <div id="socialHousingDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="socialHousingDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-reliefs.dates", messages("ated.choose-reliefs.dates.day"), messages(chooseSingleReliefsocialHousingMessage))</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="socialHousingDate-day" name="socialHousingDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="socialHousingDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-reliefs.dates", messages("ated.choose-reliefs.dates.month"), messages(chooseSingleReliefsocialHousingMessage))</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="socialHousingDate-month" name="socialHousingDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="socialHousingDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-reliefs.dates", messages("ated.choose-reliefs.dates.year"), messages(chooseSingleReliefsocialHousingMessage))</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="socialHousingDate-year" name="socialHousingDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>

}

@equityReleaseDateConditional = {
    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset" role="group" aria-describedby="equityReleaseDate-hint">
        <legend class="govuk-fieldset__legend">
            @messages("ated.choose-reliefs.date", messages("ated.choose-single-relief.equityRelease"))
        </legend>
        <div id="equityReleaseDate-hint" class="govuk-hint">
          @messages("ated.choose-reliefs.relief-hint", formattedPeriodStartDate)
        </div>
        <div class="govuk-date-input" id="passport-issued">
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="equityReleaseDate-day">
                <span aria-hidden="true">Day</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.equityRelease.hiddenContentDay")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="equityReleaseDate-day" name="equityReleaseDate-day" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="equityReleaseDate-month">
                <span aria-hidden="true">Month</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.equityRelease.hiddenContentMonth")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="equityReleaseDate-month" name="equityReleaseDate-month" type="text" inputmode="numeric">
            </div>
          </div>
          <div class="govuk-date-input__item">
            <div class="govuk-form-group">
              <label class="govuk-label govuk-date-input__label" for="equityReleaseDate-year">
                <span aria-hidden="true">Year</span>
                <span class="govuk-visually-hidden">@messages("ated.choose-single-relief.equityRelease.hiddenContentYear")</span>
              </label>
              <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="equityReleaseDate-year" name="equityReleaseDate-year" type="text" inputmode="numeric">
            </div>
          </div>
        </div>
      </fieldset>
    </div>
}

@newMain(title = titleBuilder(messages("ated.choose-reliefs.title"), Some(amendedForm)),
        serviceInfoContent = serviceInfoContent) {

    @backLinkHtml

    @if(amendedForm.errors.nonEmpty) {
      @govukErrorSummary(ErrorSummary().withFormErrorsAsText(amendedForm,
        mapping = Map(
                        "rentalBusinessDate" -> "rentalBusinessDate.day",
                        "openToPublicDate" -> "openToPublicDate.day",
                        "propertyDeveloperDate" -> "propertyDeveloperDate.day",
                        "propertyTradingDate" -> "propertyTradingDate.day",
                        "lendingDate" -> "lendingDate.day",
                        "employeeOccupationDate" -> "employeeOccupationDate.day",
                        "farmHousesDate" -> "farmHousesDate.day",
                        "socialHousingDate" -> "socialHousingDate.day",
                        "equityReleaseDate" -> "equityReleaseDate.day",
                        ""                  -> "rentalBusiness"
        )))
    }

    <header>
      <h1 class="govuk-heading-xl govuk-!-margin-bottom-5">
        <span class="govuk-caption-xl"><span class="govuk-visually-hidden">@messages("ated.screen-reader.section") </span>@messages("ated.choose-reliefs.subheader")</span>
        @messages("ated.choose-reliefs.header")
      </h1>
    </header>

        <p class="govuk-body" id="lede-text">@messages("ated.choose-reliefs.info")</p>
        <p class="govuk-body" id="choose-reliefs-label">@messages("ated.choose-reliefs.label")</p>

        @formHelper(action=controllers.reliefs.routes.ChooseReliefsController.send(periodKey)) {

            <div id="reliefs">
                @govukCheckboxes(Checkboxes(
                    fieldset = Some(Fieldset(
                        legend = Some(Legend(
                            content = Text(messages("ated.choose-reliefs.header")),
                            classes = "govuk-visually-hidden"
                        ))
                    )),
                    name = "reliefs",
                    items = Seq(
                        CheckboxItem(
                            name = Some("rentalBusiness"),
                            id = Some("rentalBusiness"),
                            content = Text(Messages("ated.choose-reliefs.rentalBusiness")),
                            value = "true",
                            checked = reliefsForm("rentalBusiness").value.contains("true"),
                            conditionalHtml = Some(rentalBusinessDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("openToPublic"),
                            id = Some("openToPublic"),
                            content = Text(Messages("ated.choose-reliefs.openToPublic")),
                            value = "true",
                            checked = reliefsForm("openToPublic").value.contains("true"),
                            conditionalHtml = Some(openToPublicDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("propertyDeveloper"),
                            id = Some("propertyDeveloper"),
                            content = Text(Messages("ated.choose-reliefs.propertyDeveloper")),
                            value = "true",
                            checked = reliefsForm("propertyDeveloper").value.contains("true"),
                            conditionalHtml = Some(propertyDeveloperDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("propertyTrading"),
                            id = Some("propertyTrading"),
                            content = Text(Messages("ated.choose-reliefs.propertyTrading")),
                            value = "true",
                            checked = reliefsForm("propertyTrading").value.contains("true"),
                            conditionalHtml = Some(propertyTradingDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("lending"),
                            id = Some("lending"),
                            content = Text(Messages("ated.choose-reliefs.lending")),
                            value = "true",
                            checked = reliefsForm("lending").value.contains("true"),
                            conditionalHtml = Some(lendingDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("employeeOccupation"),
                            id = Some("employeeOccupation"),
                            content = Text(Messages("ated.choose-reliefs.employeeOccupation")),
                            value = "true",
                            checked = reliefsForm("employeeOccupation").value.contains("true"),
                            conditionalHtml = Some(employeeOccupationDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("farmHouses"),
                            id = Some("farmHouses"),
                            content = Text(Messages("ated.choose-reliefs.farmHouses")),
                            value = "true",
                            checked = reliefsForm("farmHouses").value.contains("true"),
                            conditionalHtml = Some(farmHousesDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("socialHousing"),
                            id = Some("socialHousing"),
                            content = Text(Messages(chooseReliefsocialHousingMessage)),
                            value = "true",
                            checked = reliefsForm("socialHousing").value.contains("true"),
                            conditionalHtml = Some(socialHousingDateConditional)
                        ),
                        CheckboxItem(
                            name = Some("equityRelease"),
                            id = Some("equityRelease"),
                            content = Text(Messages("ated.choose-reliefs.equityRelease-reversion")),
                            value = "true",
                            checked = reliefsForm("equityRelease").value.contains("true"),
                            conditionalHtml = Some(equityReleaseDateConditional)
                        )
                    ),
                     errorMessage = reliefsForm.errors match {
                        case Nil => None
                        case errors => if(errors.exists(_.message == "ated.choose-reliefs.error"))  {
                            Some (ErrorMessage(content = Text(messages("ated.choose-reliefs.error"))))
                        } else None

                    }
                ))
            </div>

        @govukWarningText(WarningText(
            iconFallbackText = Some("Warning"),
            content = Text(Messages("ated.choose-reliefs-further.information.text"))
          ))

        <div class="govuk-form-group">
            @govukButton(Button(
            content = Text(messages("ated.choose-reliefs.continue")),
            inputType = Some("submit"),
            attributes = Map("id" -> "submit")
            ))
        </div>
  }
}
