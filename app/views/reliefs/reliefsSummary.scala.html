@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import models._
@import config.ApplicationConfig
@import views.html.helpers._
@import _root_.utils.PeriodUtils.{periodStartDate, periodEndDate}
@import play.twirl.api.HtmlFormat
@import uk.gov.hmrc.govukfrontend.views.Implicits._
@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.hmrcfrontend.views.html.components._
@import views.ViewUtils.titleBuilder
@import views.html.helper.CSPNonce
@import models.StringFormatting._

@this(newMain: newMain,
  formHelper: FormWithCSRF,
  govukButton : GovukButton,
  govukBackLink : GovukBackLink,
  govukWarningText : GovukWarningText,
  hmrcBanner: HmrcBanner)

@(periodKey: Int,
  reliefsTaxAvoidance : Option[ReliefsTaxAvoidance],
  canSubmit: Boolean,
  isComplete: Boolean,
  serviceInfoContent: Html = HtmlFormat.empty,
  backLink: Option[String],
  organisationName: Option[String])(implicit authContext: StandardAuthRetrievals, messages: Messages, request: Request[AnyContent], appConfig: ApplicationConfig)

@socialHousingMessage = @{
  if (periodKey >= 2020) {
    "ated.relief-summary-types.providerSocialOrHousing"
  } else {
    "ated.relief-summary-types.socialHousing"
  }
}
@backLinkHtml = {
    @if(backLink.isDefined) {
        @govukBackLink(BackLink(
            href = backLink.get,
            content = Text("Back")
        ))
    }
}

@newMain(title = titleBuilder(messages("ated.relief-summary.title")), serviceInfoContent = serviceInfoContent, back = Some(backLinkHtml)) {

  <div class="showPrint">
      @hmrcBanner(Banner())
  </div>

  <p id="reliefs-print-ated-ref" class="govuk-body showPrint govuk-!-margin-top-5">@messages("ated.refNo", authContext.atedReferenceNumber)</p>

  <header>
    <h1 class="govuk-heading-xl showPrint govuk-!-margin-bottom-5" id="property-details-summary-header-print">@messages("ated.relief-summary.print.header", organisationName.getOrElse(""))</h1>
    <h2 class="govuk-caption-xl hmrc-caption-xl">
        <span class="govuk-visually-hidden">@messages("ated.screen-reader.section")</span>
        @messages("ated.choose-reliefs.subheader")
    </h2>
    <h1 class="govuk-heading-xl govuk-!-display-none-print" id="property-details-summary-header">
      @messages("ated.relief-summary.header")
    </h1>
  </header>

  <div class="govuk-form-group">
    <p class="govuk-body" id="details-text">@messages("ated.relief-summary.details-text",
      periodStartDate(periodKey).toString(messages("ated.date-format")),
      periodEndDate(periodKey).toString(messages("ated.date-format")))
    </p>
  </div>

@reliefsTaxAvoidance.map { reliefData =>

@if(reliefData.reliefs.rentalBusiness) {

  <div class="govuk-form-group">
    <h2 id="rentalBusiness" class="govuk-heading-m">@messages("ated.relief-summary-types.rentalBusiness")</h2>
  </div>

  <dl class="govuk-summary-list">
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.datesOfRelief")
      </dt>

      <dd id="dates-rb" class="govuk-summary-list__value">
        @reliefData.reliefs.rentalBusinessDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short")) @messages("ated.relief-summary.relief-end-date")
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-rb">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.rentalBusiness")</span>
        </a>
      </dd>
    </div>

    @if(reliefData.taxAvoidance.rentalBusinessScheme.isDefined) {

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.avoidanceSchmRefNum")
      </dt>

      <dd id="tas-rb" class="govuk-summary-list__value">
        @reliefData.taxAvoidance.rentalBusinessScheme
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rb">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.rentalBusiness")</span>
        </a>
      </dd>
    </div>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
      </dt>

      <dd id="tasp-rb" class="govuk-summary-list__value">
        @reliefData.taxAvoidance.rentalBusinessSchemePromoter
      </dd>

      <dd class="govuk-summary-list__actions" id="tasp-edit-rb">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-0">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.rentalBusiness")</span>
        </a>
      </dd>
    </div>
    } else {
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
      </dt>

      <dd class="govuk-summary-list__value" id="avoidance-scheme-header-rentalBusinessScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.rentalBusiness")</span>
        </a>
      </dd>
    </div>
    }

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <span id="status-rb">@messages("ated.relief-summary.status")</span>
      </dt>
      <dd class="govuk-summary-list__value" id="status-draft-rb">
        <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.rentalBusiness") @messages("ated.relief-summary.status")</span> @messages("ated.relief-summary.draft")
      </dd>
      <dd class="govuk-summary-list__actions"></dd>

    </div>
  </dl>
}

@if(reliefData.reliefs.openToPublic) {

  <div class="govuk-form-group">
    <h2 id="openToPublic" class="govuk-heading-m">@messages("ated.relief-summary-types.openToPublic")</h2>
  </div>

  <dl class="govuk-summary-list">
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.datesOfRelief")
      </dt>

      <dd class="govuk-summary-list__value" id="dates-otp">
        @reliefData.reliefs.openToPublicDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-otp">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.openToPublic")</span>
        </a>
      </dd>

    </div>
    @if(reliefData.taxAvoidance.openToPublicScheme.isDefined) {
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.avoidanceSchmRefNum")
      </dt>

      <dd class="govuk-summary-list__value" id="tas-otp">
        @reliefData.taxAvoidance.openToPublicScheme
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-otp">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.openToPublic")</span>
        </a>
      </dd>
    </div>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
      </dt>

      <dd id="tasp-otp" class="govuk-summary-list__value">
        @reliefData.taxAvoidance.openToPublicSchemePromoter
      </dd>

      <dd class="govuk-summary-list__actions" id="tasp-edit-otp">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.openToPublic")</span>
        </a>
      </dd>

    </div>
    } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-openToPublicScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-1">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.openToPublic")</span>
          </a>
        </dd>
      </div>
    }

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
            <span id="status-otp">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-otp">
            <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.openToPublic") @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
  </dl>
}

@if(reliefData.reliefs.propertyDeveloper) {

  <div class="govuk-form-group">
    <h2 id="property-developer" class="govuk-heading-m">@messages("ated.relief-summary-types.propertyDeveloper")</h2>
  </div>

  <dl class="govuk-summary-list">
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.datesOfRelief")
      </dt>

      <dd id="dates-pd" class="govuk-summary-list__value">
        @reliefData.reliefs.propertyDeveloperDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-pd">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyDeveloper")</span>
        </a>
      </dd>
    </div>
    @if(reliefData.taxAvoidance.propertyDeveloperScheme.isDefined) {
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
      @messages("ated.relief-summary.avoidanceSchmRefNum")
      </dt>

      <dd class="govuk-summary-list__value" id="tas-pd">
        @reliefData.taxAvoidance.propertyDeveloperScheme
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-pd">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyDeveloper")</span>
        </a>
      </dd>
    </div>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
      </dt>

      <dd id="tasp-pd" class="govuk-summary-list__value">
        @reliefData.taxAvoidance.propertyDeveloperSchemePromoter
      </dd>

      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tasp-edit-pd">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyDeveloper")</span>
        </a>
      </dd>
    </div>
   } else {
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
      </dt>
      <dd class="govuk-summary-list__value" id="avoidance-scheme-header-propertyDeveloperScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-2">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyDeveloper")</span>
        </a>
      </dd>
    </div>
    }
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <span id="status-pd">@messages("ated.relief-summary.status")</span>
      </dt>
      <dd class="govuk-summary-list__value" id="status-draft-pd">
        <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.propertyDeveloper") @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
      </dd>
      <dd class="govuk-summary-list__actions"></dd>
    </div>
  </dl>
}

@if(reliefData.reliefs.propertyTrading) {

  <div class="govuk-form-group">
    <h2 id="property-trading" class="govuk-heading-m">@messages("ated.relief-summary-types.propertyTrading")</h2>
  </div>

   <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-pt" class="govuk-summary-list__value">
          @reliefData.reliefs.propertyTradingDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-pt">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyTrading")</span>
          </a>
        </dd>
      </div>
    @if(reliefData.taxAvoidance.propertyTradingScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt id="tas-rp" class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-pt">
          @reliefData.taxAvoidance.propertyTradingScheme
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-pt">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyTrading")</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
        </dt>

        <dd id="tasp-pt" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.propertyTradingSchemePromoter
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tasp-edit-pt">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyTrading")</span>
          </a>
        </dd>
      </div>
      } else {
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
      </dt>
      <dd class="govuk-summary-list__value" id="avoidance-scheme-header-propertyTradingScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
      <dd class="govuk-summary-list__actions">
        <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-3">
          @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.propertyTrading")</span>
        </a>
      </dd>
    </div>
    }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-pt">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-pt">
          <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.propertyTrading") @messages("ated.relief-summary.status")</span> @messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
   </dl>
}

@if(reliefData.reliefs.lending) {

    <div class="govuk-form-group">
      <h2 id="lending" class="govuk-heading-m">@messages("ated.relief-summary-types.lending")</h2>
    </div>

    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-ln" class="govuk-summary-list__value">
          @reliefData.reliefs.lendingDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-ln">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.lending")</span>
          </a>
        </dd>
      </div>
      @if(reliefData.taxAvoidance.lendingScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-ln">
          @reliefData.taxAvoidance.lendingScheme
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-ln">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.lending")</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="prn-ln">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter")</span>
        </dt>

        <dt id="tasp-ln" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.lendingSchemePromoter
        </dt>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tasp-edit-ln">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.lending")</span>
          </a>
        </dd>
      </div>
      } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-lendingScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-4">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.lending")</span>
          </a>
        </dd>
      </div>
      }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-ln">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-ln">
          <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.lending") @messages("ated.relief-summary.status")</span> @messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
    </dl>
}

@if(reliefData.reliefs.employeeOccupation) {

    <div class="govuk-form-group">
      <h2 id="employee-occupation" class="govuk-heading-m">@messages("ated.relief-summary-types.employeeOccupation")</h2>
    </div>

    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-eo" class="govuk-summary-list__value">
          @reliefData.reliefs.employeeOccupationDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-eo">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.employeeOccupation")</span>
          </a>
        </dd>
      </div>
      @if(reliefData.taxAvoidance.employeeOccupationScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-eo">
          @reliefData.taxAvoidance.employeeOccupationScheme
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-eo">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.employeeOccupation")</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="prn-eo">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter")</span>
        </dt>

        <dd id="tasp-eo" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.employeeOccupationSchemePromoter
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tasp-edit-eo">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.employeeOccupation")</span>
          </a>
        </dd>
      </div>
      } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-employeeOccupationScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-5">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.employeeOccupation")</span>
          </a>
        </dd>
      </div>
      }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-eo">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-eo">
          <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.employeeOccupation") @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
    </dl>
}

@if(reliefData.reliefs.farmHouses) {

    <div class="govuk-form-group">
      <h2 id="farm-houses" class="govuk-heading-m">@messages("ated.relief-summary-types.farmHouses")</h2>
    </div>

    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-fh" class="govuk-summary-list__value">
          @reliefData.reliefs.farmHousesDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)" id="dates-edit-fh">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.farmHouses")</span>
          </a>
        </dd>
      </div>
      @if(reliefData.taxAvoidance.farmHousesScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-fh">
          @reliefData.taxAvoidance.farmHousesScheme
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-fh">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.farmHouses")</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
        </dt>

        <dd id="tasp-fh" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.farmHousesSchemePromoter
        </dd>

        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tasp-edit-fh">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.farmHouses")</span>
          </a>
        </dd>
      </div>
      } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-farmHousesScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-6">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.farmHouses")</span>
          </a>
        </dd>
      </div>
      }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-fh">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-fh">
          <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.farmHouses") @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
    </dl>
}

@if(reliefData.reliefs.socialHousing) {

    <div class="govuk-form-group">
      <h2 id="social-housing" class="govuk-heading-m">@messages(socialHousingMessage)</h2>
    </div>

    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-sh" class="govuk-summary-list__value">
          @reliefData.reliefs.socialHousingDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions" id="dates-edit-sh">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages(socialHousingMessage)</span>
          </a>
        </dd>
      </div>
      @if(reliefData.taxAvoidance.socialHousingScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-sh">
          @reliefData.taxAvoidance.socialHousingScheme
        </dd>

        <dd id="tas-edit-sh" class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages(socialHousingMessage)</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
        </dt>

        <dd id="tasp-sh" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.socialHousingSchemePromoter
        </dd>

        <dd class="govuk-summary-list__actions" id="tasp-edit-sh">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages(socialHousingMessage)</span>
          </a>
        </dd>
      </div>
      } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-socialHousingScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-7">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages(socialHousingMessage)</span>
          </a>
        </dd>
      </div>
      }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-sh">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-sh">
          <span class="govuk-visually-hidden">@messages(socialHousingMessage) @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
    </dl>
}

@if(reliefData.reliefs.equityRelease) {

    <div class="govuk-form-group">
      <h2 id="equity-release" class="govuk-heading-m">@messages("ated.relief-summary-types.equityRelease")</h2>
    </div>

    <dl class="govuk-summary-list">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.datesOfRelief")
        </dt>

        <dd id="dates-er" class="govuk-summary-list__value">
          @reliefData.reliefs.equityReleaseDate.getOrElse(reliefData.periodStartDate).toString(messages("ated.date-format.short"))  @messages("ated.relief-summary.relief-end-date")
        </dd>

        <dd class="govuk-summary-list__actions" id="dates-edit-er">
          <a class="govuk-link" href="@controllers.reliefs.routes.ChooseReliefsController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.datesOfRelief") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.equityRelease")</span>
          </a>
        </dd>
      </div>
      @if(reliefData.taxAvoidance.equityReleaseScheme.isDefined) {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum")
        </dt>

        <dd class="govuk-summary-list__value" id="tas-er">
          @reliefData.taxAvoidance.equityReleaseScheme
        </dd>

        <dd id="tas-edit-er" class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.equityRelease")</span>
          </a>
        </dd>
      </div>

      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.relief-summary.avoidanceSchmRefNum-promoter")
        </dt>

        <dd id="tasp-er" class="govuk-summary-list__value">
          @reliefData.taxAvoidance.equityReleaseSchemePromoter
        </dd>

        <dd class="govuk-summary-list__actions" id="tasp-edit-er">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.relief-summary.avoidanceSchmRefNum-promoter") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.equityRelease")</span>
          </a>
        </dd>
      </div>
      } else {
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          @messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header")
        </dt>
        <dd class="govuk-summary-list__value" id="avoidance-scheme-header-equityReleaseScheme-value-not-provided">@messages("ated.property-details-summary.field-blank")</dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link" href="@controllers.reliefs.routes.AvoidanceSchemeBeingUsedController.editFromSummary(periodKey)" id="tas-edit-rp-8">
            @messages("ated.change") <span class="govuk-visually-hidden">@messages("ated.property-details-summary.table.property-ated-details.avoidance-scheme.header") @messages("ated.relief-summary.for") @messages("ated.relief-summary-types.equityRelease")</span>
          </a>
        </dd>
      </div>
      }
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <span id="status-er">@messages("ated.relief-summary.status")</span>
        </dt>
        <dd class="govuk-summary-list__value" id="status-draft-er">
          <span class="govuk-visually-hidden">@messages("ated.relief-summary-types.equityRelease") @messages("ated.relief-summary.status") </span>@messages("ated.relief-summary.draft")
        </dd>
        <dd class="govuk-summary-list__actions"></dd>
      </div>
    </dl>
}
}

<div class="govuk-form-group">

  <p class="govuk-body" id="ated-charge-text">@messages("ated.relief-summary.table.ated-charge.text")</p>

  <h2 class="govuk-heading-xl govuk-form-group" id="ated-charge-value">
    @if(isComplete) {
      @messages("ated.relief-summary.table.ated-charge.balance")
    } else {
      @messages("ated.unknown-amount.text")
    }
  </h2>

  <div class="govuk-inset-text print-hidden">
    <p class="govuk-body">@messages("ated.relief-summary.saved-draft.text")</p>
  </div>

</div>

  @govukWarningText(WarningText(
    iconFallbackText = Some("Warning"),
    content = Text(Messages("ated.choose-reliefs-further.information.text"))
  ))

  <p class="govuk-body">
    <a id="print-friendly-relief-link" href="#print" class="govuk-link govuk-body print-hidden">@Messages("ated.relief-summary.print.view")</a>

    <script @CSPNonce.attr>
       document.getElementById("print-friendly-relief-link").addEventListener("click", function(e) {
         e.preventDefault()
         window.print()
       });
    </script>
  </p>

  <p class="govuk-body">
      <a class="govuk-link" href="@controllers.routes.AccountSummaryController.view()" id="saved-returns-link">@messages("ated.property-details-summary.saved-returns.link.text")</a>
  </p>

  <p class="govuk-body">
      <a class="govuk-link" href="@controllers.reliefs.routes.ReliefsSummaryController.deleteDraft(periodKey)" id="delete-draft">@messages("ated.property-details-summary.delete-draft.link.text")</a>
  </p>

  @printBoxes()

  @formHelper(action=controllers.reliefs.routes.ReliefsSummaryController.continue(periodKey)) {
      @if(!isComplete){
      } else {
        @if(canSubmit) {
          <div class="govuk-form-group">
            @govukButton(Button(
              content = Text(messages("ated.relief-summary.submit")),
              inputType = Some("submit"),
              attributes = Map("id" -> "submit")
            ))
          </div>

        } else {
          <p class="govuk-body" id="submit-disabled-text">@messages("ated.relief-summary.submit-disabled-text")</p>
          <div class="govuk-form-group">
            @govukButton(Button(
              content = Text(messages("ated.relief-summary.submit")),
              inputType = Some("submit"),
              disabled = true,
              attributes = Map("id" -> "submit")
            ))
          </div>
        }
      }
  }
}
